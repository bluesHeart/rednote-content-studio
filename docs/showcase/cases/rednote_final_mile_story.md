# 我们把 Markdown 变成小红书卡片后，终于把“最后一公里”交还给人

你可能也遇到过这个场景：

你有一篇挺完整的技术文稿（Markdown / 笔记 / 研究记录），想发成小红书图文。  
结果不是手动切图切到崩溃，就是让 AI 一键改写后发现——

- 图文顺序不稳定
- 每页像“新开一条帖”
- 文风被模型“接管”，你失去编辑权

我们最近把这个问题当成一个完整工程重新做了一遍，做出了 **rednote-content-studio**：

> 先让 LLM 干重体力活（解析、分页、初稿），
> 再把最后一公里交给用户自己（块级编辑、锁定、局部重写、拖拽图片）。

这篇文章不讲空话，直接用真实截图讲清楚它怎么工作、为什么这么设计。

> 开源仓库（GitHub）：https://github.com/bluesHeart/rednote-content-studio
>
> 如果你想直接上手，建议先 `Star` 再拉代码，后续版本迭代会持续推送。

---

## 先看成品：它不是“纯文字改写器”，而是“图文卡片生成链路”

输入是一份普通 Markdown（可含图片链接、列表、代码段）。

输出是：

- 每页可直接复制发布的文本
- 每页 HTML + PNG 预览
- 合并预览页
- 可编辑中间层（最后一公里手动微调）

先看两张拼接图（真实生成结果）：

![Demo 卡片拼接 A（1-2页）](article_assets/21_cards_pair_clean_a.png)

![Demo 卡片拼接 B（3-9页）](article_assets/22_cards_pair_clean_b.png)

你会发现一个关键点：**图片是跟正文流动的，不是统一堆到页顶。**

---

## 为什么之前的方案经常翻车？

我们自己踩过一轮完整的坑，核心不是“prompt 不够长”，而是架构问题：

1. 只靠全局 LLM 改写，图片位置容易漂移  
2. 只靠程序规则硬拆句，会变成“规则屎山”  
3. 一次性生成后不可编辑，用户只能接受或重来

所以我们最后定下来的原则是：

> **LLM 负责生成，用户负责定稿。**

这决定了后面的整个系统结构。

---

## Web App 实拍：从粘贴到生成，大概就是这条链路

流程看这两张拼接图就够了：

- 左到右：空白首页 → 粘贴 Markdown
- 左到右：转换中进度 → 转换后卡片预览 + 最后一公里编辑区

![Web 流程拼接 A](article_assets/18_web_flow_pair_clean_a.png)

![Web 流程拼接 B](article_assets/19_web_flow_pair_clean_b.png)

---

## 这次最关键的改动：把“最后一公里”做成可编辑中间层

我们新增了一层 `editable_story`，每页被拆成若干块：

- `title`
- `text`
- `image`

每个块都有自己的 `id` 和 `locked` 状态。

这意味着：

- 你可以手改某几个文本块，不动其他块
- 可以锁定你满意的块，后续重写不许碰
- 可以直接调整图片块顺序（这次我们补了拖拽）

界面里这块就是“最后一公里微调”（左：块级编辑，右：单卡详情弹窗）：

![最后一公里编辑与预览弹窗](article_assets/20_web_edit_pair_clean.png)

---

## “局部重写”是怎么避免失控的？

以前常见模式是：你给一句“再口语一点”，模型把整页甚至整篇都洗掉。

现在我们做的是：

1. 只重写当前页
2. 只重写未锁定文本块
3. 图片块不改，顺序不乱
4. 锁定块绝对不动

所以它不是“再生成一版看运气”，而是一个可控编辑过程。

---

## 如果你是技术团队，这个项目最有价值的不是 UI，而是思路

我们这次最想传递的，其实是一个产品/工程方法：

### 1) 不要迷信一次性生成

一次性生成适合 demo，不适合内容生产。

### 2) 把 LLM 放在“可回滚、可约束、可局部替换”的链路里

让它做擅长的“高维改写”，不要让它做最后拍板。

### 3) 给用户“结构化编辑权”，而不是一个大文本框

块级编辑 + 锁定 + 局部重写，比“全篇再来一版”稳定太多。

---

## 实际体验一句话总结

我们不是在做“更会写的小红书 AI”。

我们在做的是：

> 一个把复杂转换流程自动化、但把最终决定权还给人的内容系统。

如果你也在做“AI 生成 + 人工收口”的产品（不管是内容、设计还是代码），欢迎拿这个思路对照你现在的架构：

- 哪些环节必须机器干？
- 哪些环节必须人拍板？
- 中间层是不是足够可编辑、可审计、可回退？

---

## 附：本次文章截图清单（均来自项目真实运行）

- Web 流程拼接 A（首页 + 粘贴）：`docs/showcase/article_assets/18_web_flow_pair_clean_a.png`
- Web 流程拼接 B（转换中 + 转换后）：`docs/showcase/article_assets/19_web_flow_pair_clean_b.png`
- 最后一公里拼接（编辑区 + 单卡弹窗）：`docs/showcase/article_assets/20_web_edit_pair_clean.png`
- Demo 卡片拼接 A（第 1-2 页）：`docs/showcase/article_assets/21_cards_pair_clean_a.png`
- Demo 卡片拼接 B（第 3/9 页）：`docs/showcase/article_assets/22_cards_pair_clean_b.png`

---

## 最后：如果这套思路对你有用

欢迎直接到 GitHub 看代码、提 Issue、提 PR：

- 仓库地址：https://github.com/bluesHeart/rednote-content-studio
- 建议先 Star，后续版本更新你能第一时间看到

如果你愿意，我下一篇可以直接写“这套架构的技术拆解版”（接口、数据结构、可观测性、回滚策略）。
